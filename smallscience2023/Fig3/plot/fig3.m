clear;
close all;
clc;

fig = figure;
npt = 500;
x3=[0.0 0.0 0.0 0.0 0.0 -0.177500000000000  -0.177500000000000  -0.177500000000000  -0.177500000000000  -0.355000000000000 -0.355000000000000  -0.355000000000000  -0.532500000000000  -0.532500000000000  -0.710000000000000];
y3=[10.888972750000001  11.196411767500001  11.503850785000001  11.811289802499999  12.118728819999999 10.888972750000001  11.196411767500001  11.503850785000001  11.811289802499999  10.888972750000001 11.196411767500001  11.503850785000001  10.888972750000001  11.196411767500001  10.888972750000001];
%x3=[-0.614878036687000  -0.614878036687000  -0.614878036687000  -0.614878036687000  -0.614878036687000 -0.307439018343500  -0.307439018343500  -0.307439018343500  -0.307439018343500                   0.0 0.0                 0.0   0.307439018343500   0.307439018343500   0.614878036687000];
%y3=[0.0   0.177500000000000   0.355000000000000   0.532500000000000   0.710000000000000 0.0   0.177500000000000   0.355000000000000   0.532500000000000                   0.0 0.177500000000000   0.355000000000000                   0.0   0.177500000000000                   0.0];
%cd pris-wz;
%clear z3;

b = 0.49;
r = 0.49;

rr = linspace(1,1,100)';
tmp1 = linspace(1,0.04,100)';
for i =1: 100
    tmpmod1(i) = tmp1(i)^(1/2.2);
end

tmp2 = linspace(0.04,1,100)';
for i =1: 100
    tmpmod2(i) = tmp2(i)^(1/2.2);
end
wtr3=[tmpmod2',tmpmod2',linspace(1,1,100)'];
wtr4=[linspace(1,1,100)',tmpmod1',tmpmod1'];
wtr = [wtr3 ; wtr4];

for i = 1:15
    filename = [num2str(i-1),'-curr.data'];
    clear B;
    B = load (filename);
    z3(i) = max(abs(B(:,2)));
end
clear A;
A = [x3' y3' z3'];
xx3 = linspace(min(A(:,1)),max(A(:,1)),npt);
yy3 = linspace(min(A(:,2)),max(A(:,2)),npt);
yy3 = yy3';
for jj = 1:npt
    xx3(jj,:) = xx3(1,:);
end

for jj = 1:npt
    yy3(:,jj) = yy3(:,1);
end

zz3 = griddata(A(:,1),A(:,2),A(:,3),xx3,yy3,'v4');
contourf(xx3,yy3,zz3,100,'LineStyle','none');
colormap(wtr);
%clim([1.5 4]);
%clim([0.08 0.28]);
xlim([-0.71,0]);
ylim([10.888972750000001,12.118728819999999]);
axis equal;
saveas(fig, 'map','pdf');